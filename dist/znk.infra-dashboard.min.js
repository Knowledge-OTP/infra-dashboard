!function(a){"use strict";a.module("znk.infra-dashboard",["znk.infra-dashboard.groups","znk.infra-dashboard.modal","znk.infra-dashboard.utils"])}(angular),function(a){"use strict";a.module("znk.infra-dashboard.utils",[])}(angular),function(a){"use strict";a.module("znk.infra-dashboard.groups",[])}(angular),function(a){"use strict";a.module("znk.infra-dashboard.modal",[])}(angular),function(a){"use strict";a.module("znk.infra-dashboard.utils").filter("cutString",[function(){return function(a,b){if(!a)return"";if(a.length<b)return a;for(var c=a.split(" "),d="",e=0;e<c.length&&d.length+c[e].length<=b;e++)d=d+c[e]+" ";return d+"..."}}])}(angular),function(a){"use strict";a.module("znk.infra-dashboard.groups").provider("GroupsService",[function(){var b,c;this.setHelpersServiceName=function(a,d){b=a,c=d},this.$get=["$injector","ENV","$q","$log",function(d,e,f,g){function h(){var a=k.getAuth(),b=e.fbDataEndPoint+e.firebaseAppScopeName+"/"+m,c=b.replace("$$uid",a.uid);return new Firebase(c,e.firebaseAppScopeName)}function i(){var a={};return a[j.defaultGroupName]={name:j.defaultGroupName,groupKey:j.defaultGroupName},a}var j={defaultGroupName:"assorted"},k=d.get(c),l=d.get(b),m=l.variables.appUserSpacePath+"/groups",n=[],o=[],p=h();return j.createGroup=function(b){var c=this;return c.getAllGroups().then(function(d){var e=1,f=j.defaultGroupName;for(Object.keys(d).length&&(f=Object.keys(d).length+e);a.isDefined(d[f]);)e++,f=Object.keys(d).length+e;return d[f]={name:b,groupKey:f},c.setGroups(d)})},j.updateStudent=function(a,b,c){if(!a)return g.error("GroupsService.updateStudent:: student group key not defined"),f.reject("student group key not defined");var d=this;return d.getGroup(a).then(function(e){return c?e.students[b]=c:delete e.students[b],d.setGroup(a,e).then(function(){return d.getAllGroups()})})},j.getAllGroups=function(){return l.get(m,i())},j.moveToGroup=function(b,c){if(!b)return g.error("GroupsService.moveToGroup:: to group key not defined"),f.reject("to group key not defined");var d=this;return d.getAllGroups().then(function(e){var f={};return a.forEach(c,function(b){a.forEach(e,function(a){a.students&&a.students[b]&&(f[b]=a.students[b],delete a.students[b])})}),e[b].students||(e[b].students={}),a.forEach(c,function(a){e[b].students[a]=f[a]}),d.setGroups(e)})},j.setGroups=function(a){return l.set(m,a)},j.setGroup=function(a,b){if(!a)return g.error("GroupsService.setGroup:: group key not defined"),f.reject("group key not defined");var c=this;return this.getAllGroups().then(function(d){return d[a]=b,c.setGroups(d)})},j.getGroup=function(a){return this.getAllGroups().then(function(b){return b[a]})},j.deleteGroup=function(b){return j.getAllGroups().then(function(c){var d=a.copy(c[b].students);return delete c[b],a.forEach(d,function(a,b){c[j.defaultGroupName].students[b]=a}),j.setGroups(c)})},j.editGroupName=function(a,b){return a?j.getGroup(a).then(function(c){return c.name=b,j.setGroup(a,c)}):(g.error("GroupsService.editGroupName:: group key not defined"),f.reject("group key not defined"))},p.on("value",function(a){var b=a.val();j.getAllGroups().then(function(a){var c=Object.keys(a);if(c.forEach(function(c){b&&!b[c]&&delete a[c]}),b){var d=Object.keys(b);d.forEach(function(c){a[c]=b[c]})}n.forEach(function(b){b(a)})})}),p.on("child_changed",function(b){var c=b.val();j.getAllGroups().then(function(b){var d=0,e=0;b[c.groupKey]&&b[c.groupKey].students&&(d=Object.keys(b[c.groupKey].students).length),c&&c.students&&(e=Object.keys(c.students).length),e>d&&a.forEach(c.students,function(a){b[c.groupKey].students&&b[c.groupKey].students[a.receiverUid]||o.forEach(function(b){b(a)})})})}),j.addGroupsChangeListener=function(a){j.getAllGroups().then(function(b){a(b)}),n.push(a)},j.removeGroupsChangeListener=function(a){var b=n.indexOf(a);b!==-1&&n.splice(b,1)},j.addGroupsChildAddedListener=function(a){o.push(a)},j.removeGroupsChildAddedListener=function(a){var b=o.indexOf(a);b!==-1&&o.splice(b,1)},j}]}])}(angular),function(a){function b(){var a;this.setBaseTemplatePath=function(b){a=b},this.$get=["$mdDialog",function(b){var c={};return c.showBaseModal=function(c){b.show({locals:{svgIcon:c.svgIcon,innerTemplateUrl:c.innerTemplateUrl,overrideCssClass:c.overrideCssClass,modalData:c.modalData,modalName:c.modalName,closeModal:function(){b.hide()}},bindToController:!0,controller:c.controllerName,controllerAs:"vm",templateUrl:a,clickOutsideToClose:!0,escapeToClose:!0})},c}]}a.module("znk.infra-dashboard.modal").provider("ModalService",b)}(angular),angular.module("znk.infra-dashboard").run(["$templateCache",function(a){}]);